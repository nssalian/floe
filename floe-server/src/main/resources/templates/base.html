{! Base layout template for Floe UI !} {! All pages extend this with {#include
base}{#title}Page Title{/title}{#content}...{/content}{/include} !}
<!doctype html>
<html lang="en" class="h-full">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>{#insert title}Floe{/insert} | Floe</title>

        {! Tailwind CSS via CDN - swap for build step in production !}
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            // Iceberg-inspired palette: deep ocean blues with glacier accents
                            floe: {
                                50: "#f0f9ff",
                                100: "#e0f2fe",
                                200: "#bae6fd",
                                300: "#7dd3fc",
                                400: "#38bdf8",
                                500: "#0ea5e9",
                                600: "#0284c7",
                                700: "#0369a1",
                                800: "#075985",
                                900: "#0c4a6e",
                                950: "#082f49",
                            },
                            glacier: {
                                50: "#ecfeff",
                                100: "#cffafe",
                                200: "#a5f3fc",
                                300: "#67e8f9",
                                400: "#22d3ee",
                                500: "#06b6d4",
                            },
                        },
                        fontFamily: {
                            sans: ["IBM Plex Sans", "system-ui", "sans-serif"],
                            mono: ["IBM Plex Mono", "monospace"],
                        },
                    },
                },
            };
        </script>

        {! IBM Plex fonts !}
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=IBM+Plex+Sans:wght@400;500;600;700&display=swap"
            rel="stylesheet"
        />

        {! htmx from CDN !}
        <script src="https://unpkg.com/htmx.org@1.9.10"></script>

        {! Custom styles !}
        <style>
            /* Smooth transitions for htmx swaps */
            .htmx-swapping {
                opacity: 0;
                transition: opacity 150ms ease-out;
            }
            .htmx-settling {
                opacity: 1;
                transition: opacity 150ms ease-in;
            }

            /* Loading indicator */
            .htmx-request .htmx-indicator {
                display: inline-flex;
            }
            .htmx-indicator {
                display: none;
            }

            /* Pulse animation for running operations */
            @keyframes pulse-dot {
                0%,
                100% {
                    opacity: 1;
                }
                50% {
                    opacity: 0.4;
                }
            }
            .animate-pulse-dot {
                animation: pulse-dot 1.5s ease-in-out infinite;
            }

            /* Table row hover */
            .table-row-hover:hover {
                background-color: rgb(240 249 255 / 0.5);
            }
        </style>

        {#insert head}{/insert}
    </head>
    <body class="h-full bg-slate-50 font-sans text-slate-900 antialiased">
        <div class="min-h-full">
            {! Navigation !}
            <nav class="bg-floe-950 shadow-lg">
                <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
                    <div class="flex h-16 items-center justify-between">
                        {! Logo !}
                        <div class="flex items-center gap-3">
                            <a
                                href="/ui/"
                                class="flex items-center gap-3 group"
                            >
                                <div
                                    class="w-9 h-9 rounded-lg bg-gradient-to-br from-glacier-400 to-floe-500 flex items-center justify-center shadow-inner"
                                >
                                    <svg
                                        class="w-5 h-5 text-white"
                                        fill="none"
                                        stroke="currentColor"
                                        viewBox="0 0 24 24"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"
                                        />
                                    </svg>
                                </div>
                                <span
                                    class="text-xl font-semibold text-white tracking-tight group-hover:text-glacier-300 transition-colors"
                                >
                                    Floe
                                </span>
                            </a>
                        </div>

                        {! Main nav !}
                        <div class="hidden md:block">
                            <div class="flex items-center space-x-1">
                                {#for item in navItems.orEmpty}
                                <a
                                    href="{item.href}"
                                    hx-boost="false"
                                    class="px-4 py-2 rounded-lg text-sm font-medium transition-all duration-150 {#if item.active} bg-floe-800/50 text-white {#else} text-floe-200 hover:bg-floe-800/30 hover:text-white {/if}"
                                >
                                    {item.label}
                                </a>
                                {/for}
                            </div>
                        </div>

                        {! Right side - status indicator !}
                        <div class="flex items-center gap-4">
                            <div
                                class="flex items-center gap-2 text-sm text-floe-300"
                            >
                                <span
                                    class="w-2 h-2 rounded-full bg-emerald-400 animate-pulse-dot"
                                ></span>
                                <span class="hidden sm:inline">Connected</span>
                            </div>
                        </div>
                    </div>
                </div>

                {! Mobile nav !}
                <div class="md:hidden border-t border-floe-800">
                    <div class="flex px-2 py-2 space-x-1">
                        {#for item in navItems.orEmpty}
                        <a
                            href="{item.href}"
                            hx-boost="false"
                            class="flex-1 px-3 py-2 rounded-lg text-center text-sm font-medium transition-all {#if item.active} bg-floe-800/50 text-white {#else} text-floe-200 hover:bg-floe-800/30 hover:text-white {/if}"
                        >
                            {item.label}
                        </a>
                        {/for}
                    </div>
                </div>
            </nav>

            {! Page header - optional !} {#insert header}{/insert} {! Main
            content !}
            <main class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8">
                {! Toast container for notifications !}
                <div
                    id="toast-container"
                    class="fixed top-20 right-4 z-50 flex flex-col gap-2 pointer-events-none"
                ></div>

                {! Error container for htmx errors !}
                <div id="error-container" class="mb-6"></div>

                {#insert content}No content{/insert}
            </main>

            {! Footer !}
            <footer class="mt-auto border-t border-slate-200 bg-white">
                <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6">
                    <div
                        class="flex flex-col sm:flex-row justify-between items-center gap-4 text-sm text-slate-500"
                    >
                        <div class="flex items-center gap-2">
                            <span>Floe</span>
                            <span class="text-slate-300">â€¢</span>
                            <span>Iceberg Table Maintenance System</span>
                        </div>
                        <div class="flex items-center gap-4">
                            <a
                                href="/api"
                                class="hover:text-floe-600 transition-colors"
                                >API</a
                            >
                            <a
                                href="/health"
                                class="hover:text-floe-600 transition-colors"
                                >Health</a
                            >
                            <a
                                href="/metrics"
                                class="hover:text-floe-600 transition-colors"
                                >Metrics</a
                            >
                        </div>
                    </div>
                </div>
            </footer>
        </div>

        {! htmx error handling - wrapped in raw block to prevent Qute parsing JS
        bracket notation !}
        <script>
            {|
                document.body.addEventListener('htmx:responseError', function(evt) {
                    const container = document.getElementById('error-container');
                    const status = evt.detail.xhr.status;
                    const message = status === 0
                        ? 'Network error - please check your connection'
                        : `Error ${status}: ${evt.detail.xhr.statusText}`;

                    container.innerHTML = `
                        <div class="rounded-lg bg-red-50 border border-red-200 p-4 flex items-start gap-3">
                            <svg class="w-5 h-5 text-red-500 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            <div class="flex-1">
                                <p class="text-sm font-medium text-red-800">${message}</p>
                            </div>
                            <button onclick="this.parentElement.remove()"
                                    class="text-red-500 hover:text-red-700 transition-colors">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                </svg>
                            </button>
                        </div>
                    `;

                    // Auto-dismiss after 10 seconds
                    setTimeout(() => {
                        container.innerHTML = '';
                    }, 10000);
                });

                // Toast helper function
                function showToast(message, type = 'info') {
                    const container = document.getElementById('toast-container');
                    const colors = {
                        success: 'bg-emerald-500',
                        error: 'bg-red-500',
                        info: 'bg-floe-500',
                        warning: 'bg-amber-500'
                    };

                    const toast = document.createElement('div');
                    toast.className = `${colors[type]} text-white px-4 py-3 rounded-lg shadow-lg pointer-events-auto
                                      transform transition-all duration-300 translate-x-full opacity-0`;
                    toast.innerHTML = `
                        <div class="flex items-center gap-3">
                            <span class="text-sm font-medium">${message}</span>
                            <button onclick="this.parentElement.parentElement.remove()" class="hover:opacity-75">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                </svg>
                            </button>
                        </div>
                    `;

                    container.appendChild(toast);

                    // Animate in
                    requestAnimationFrame(() => {
                        toast.classList.remove('translate-x-full', 'opacity-0');
                    });

                    // Auto-remove after 5 seconds
                    setTimeout(() => {
                        toast.classList.add('translate-x-full', 'opacity-0');
                        setTimeout(() => toast.remove(), 300);
                    }, 5000);
                }
            |}
        </script>

        {#insert scripts}{/insert}
    </body>
</html>
